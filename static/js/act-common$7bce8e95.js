var ActComm={init:function(){window.actData&&(this.initReport(),this.initShare(),this.initImagPreview(),this.initOpenAssitant())},initReport:function(){function t(t,n,i){console.log("will report:",t,n),n&&window.actData&&(window.actData.vid||window.actData.gid)&&(new Image(1,1).src="/wework_admin/report?type=img&r="+Math.random()+"&q="+encodeURIComponent("st:sgkvuin_report="+JSON.stringify({kv:+t||79503205,key:n,value:1,vid:+window.actData.vid,gid:+window.actData.gid,corp_id:window.actData.corp_id,strid:window.actData.scorp_id}))),i&&"function"==typeof i&&i()}window.actReport=t,this.actReport=t},initShare:function(){window.actData.shareInfo&&!1===window.actData.shareInfo.open?document.addEventListener("WeixinJSBridgeReady",(function(){WeixinJSBridge.invoke("hideOptionMenu",{},(function(){}))}),!1):window.actData.shareInfo.shareFunc&&"function"==typeof window.actData.shareInfo.shareFunc?window.actData.shareInfo.shareFunc():/MicroMessenger/gi.test(navigator.userAgent)&&(wxUtils.onMenuShareAppMessage({title:window.actData.shareInfo.title,desc:window.actData.shareInfo.desc,link:window.actData.shareInfo.link,imgUrl:window.actData.shareInfo.imgUrl,success:function(){},cancel:function(){}}),wxUtils.onMenuShareTimeline({title:window.actData.shareInfo.title,link:window.actData.shareInfo.link,imgUrl:window.actData.shareInfo.imgUrl,success:function(){},cancel:function(){}}))},initImagPreview:function(){if(!1!==window.actData.imgPreview){var t=function(t){return"string"!=typeof t||!/^(f|ht)tps?:\/\//i.test(t)&&t.indexOf("rescdn.qqmail.com")>-1&&(t="https:"+t),t};document.addEventListener("WeixinJSBridgeReady",(function(){!function(){for(var n=document.querySelectorAll(".js_act_image"),i=[],e=[],a=0,o=n.length;a<o;a++){var c=n[a].src.replace(/"/g,"");c&&(i.push(t(n[a])),e.push(t(c)))}for(a=0,o=i.length;a<o;a++)!function(){var t=a;i[t].addEventListener("click",(function(n){WeixinJSBridge.invoke("imagePreview",{current:e[t],urls:e},(function(t){}))}))}()}()}),!1)}},_insertScript:function(t,n){var i=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.src=t,i.appendChild(e),n&&"function"==typeof n&&n()},_getQueryString:function(t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(n),e="";return null!=i&&(e=i[2]),n=null,i=null,null==e||""==e||"undefined"==e?"":e},initOpenAssitant:function(){window.openAssitant=function(t,n,i="",e=""){AssistantHelper&&new AssistantHelper({type:t,data:{id:n,first_category_id:i,second_category_id:e}}).goAssistant()}}};ActComm.init();